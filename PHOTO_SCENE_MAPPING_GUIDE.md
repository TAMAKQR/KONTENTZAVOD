# üì∏ –ö–∞–∫ —Ñ–æ—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ü–µ–Ω–∞–º –≤ —Ä–µ–∂–∏–º–µ Text+Photo

## –ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: **–ü–û–†–Ø–î–û–ö –°–û–í–ü–ê–î–ê–ï–¢ –û–î–ò–ù-–í-–û–î–ò–ù** ‚úÖ

–ï—Å–ª–∏ –≤—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ 3 —Ñ–æ—Ç–æ –≤ —Ç–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. –§–æ—Ç–æ 1 (–ø–ª—è–∂)
2. –§–æ—Ç–æ 2 (–∑–∞–∫–∞—Ç)
3. –§–æ—Ç–æ 3 (–ø–∞–ª—å–º—ã)

–¢–æ —Å–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—Å—Ç 3 —Å—Ü–µ–Ω—ã –∏ **–∫–∞–∂–¥–æ–π —Å—Ü–µ–Ω–µ –¥–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –°–í–û–ï —Ñ–æ—Ç–æ –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ**:

```
üì∏ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ "–û—Ç–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ç–æ 1 (–ø–ª—è–∂)"               ‚îÇ
‚îÇ ‚úÖ –§–æ—Ç–æ 1 –∑–∞–≥—Ä—É–∂–µ–Ω–æ!                    ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ "–û—Ç–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ç–æ 2 (–∑–∞–∫–∞—Ç)"              ‚îÇ
‚îÇ ‚úÖ –§–æ—Ç–æ 2 –∑–∞–≥—Ä—É–∂–µ–Ω–æ!                    ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ "–û—Ç–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ç–æ 3 (–ø–∞–ª—å–º—ã)"             ‚îÇ
‚îÇ ‚úÖ –§–æ—Ç–æ 3 –∑–∞–≥—Ä—É–∂–µ–Ω–æ!                    ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ /–≥–æ—Ç–æ–≤–æ                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì –ü–ï–†–ï–î–ê–ï–¢–°–Ø –í –°–ò–°–¢–ï–ú–£ ‚Üì

üìÇ –°–ø–∏—Å–æ–∫ file_ids (Telegram):
[file_id_1, file_id_2, file_id_3]
     ‚Üì
photo_file_ids = [
    "file_id_–ø–ª—è–∂",
    "file_id_–∑–∞–∫–∞—Ç",
    "file_id_–ø–∞–ª—å–º—ã"
]

           ‚Üì –û–ë–†–ê–ë–û–¢–ö–ê –§–û–¢–û ‚Üì

üåê –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ ImgBB (–ø–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö URL):
scene_image_urls = [
    "https://i.ibb.co/abc123.jpg",  # URL –ø–ª—è–∂–∞
    "https://i.ibb.co/def456.jpg",  # URL –∑–∞–∫–∞—Ç–∞
    "https://i.ibb.co/ghi789.jpg"   # URL –ø–∞–ª—å–º
]

           ‚Üì –°–û–ó–î–ê–ù–ò–ï –°–¶–ï–ù ‚Üì

üé¨ –°—Ü–µ–Ω—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
scenes = [
    {
        "id": 1,
        "prompt": "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ - –ß–∞—Å—Ç—å 1",
        "duration": 5,
        "aspect_ratio": "16:9"
    },
    {
        "id": 2,
        "prompt": "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ - –ß–∞—Å—Ç—å 2",
        "duration": 5,
        "aspect_ratio": "16:9"
    },
    {
        "id": 3,
        "prompt": "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ - –ß–∞—Å—Ç—å 3",
        "duration": 5,
        "aspect_ratio": "16:9"
    }
]

           ‚Üì –ì–ï–ù–ï–†–ê–¶–ò–Ø –í–ò–î–ï–û ‚Üì

üìπ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ Replicate:

–°—Ü–µ–Ω–∞ 1 + URL –ø–ª—è–∂–∞      ‚Üí generate_scene(prompt=..., start_image_url="https://i.ibb.co/abc123.jpg")
                            ‚Üì
                            Video 1 (5 —Å–µ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–æ—Ç–æ –ø–ª—è–∂–∞)

–°—Ü–µ–Ω–∞ 2 + URL –∑–∞–∫–∞—Ç–∞     ‚Üí generate_scene(prompt=..., start_image_url="https://i.ibb.co/def456.jpg")
                            ‚Üì
                            Video 2 (5 —Å–µ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–æ—Ç–æ –∑–∞–∫–∞—Ç–∞)

–°—Ü–µ–Ω–∞ 3 + URL –ø–∞–ª—å–º      ‚Üí generate_scene(prompt=..., start_image_url="https://i.ibb.co/ghi789.jpg")
                            ‚Üì
                            Video 3 (5 —Å–µ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–æ—Ç–æ –ø–∞–ª—å–º)

           ‚Üì –°–ö–õ–ï–ò–í–ê–ù–ò–ï ‚Üì

üé¨ –§–∏–Ω–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ:
[Video 1] ‚Üí [Video 2] ‚Üí [Video 3]
(5 —Å–µ–∫)    (5 —Å–µ–∫)    (5 —Å–µ–∫)
= 15 —Å–µ–∫—É–Ω–¥ –≤—Å–µ–≥–æ
```

---

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–¥–µ

### –®–∞–≥ 1: –°–±–æ—Ä —Ñ–æ—Ç–æ (handlers/video_handler.py, lines 612-627)

```python
@router.message(VideoStates.text_photo_waiting_photo)
async def process_text_photo_image(message: types.Message, state: FSMContext):
    if message.photo:
        data = await state.get_data()
        photos = data.get("photos", [])  # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫
        photos.append(message.photo[-1].file_id)  # –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ –≤ –ö–û–ù–ï–¶ —Å–ø–∏—Å–∫–∞

        await state.update_data(photos=photos)
        await message.answer(f"‚úÖ –§–æ—Ç–æ {len(photos)} –∑–∞–≥—Ä—É–∂–µ–Ω–æ!")  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–º–µ—Ä
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
photos = [
    file_id_1,  # –∏–Ω–¥–µ–∫—Å 0 ‚Üí –§–æ—Ç–æ 1
    file_id_2,  # –∏–Ω–¥–µ–∫—Å 1 ‚Üí –§–æ—Ç–æ 2
    file_id_3   # –∏–Ω–¥–µ–∫—Å 2 ‚Üí –§–æ—Ç–æ 3
]
```

---

### –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ (handlers/video_handler.py, lines 700-724)

```python
uploader = ImageUploader()
scene_image_urls = []

for i, file_id in enumerate(photo_file_ids, 1):  # i = 1, 2, 3...
    image_url = await uploader.process_telegram_photo(
        message.bot,
        file_id,  # –ö–∞–∂–¥—ã–π file_id –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ –ø–æ—Ä—è–¥–∫—É
        photo_name=f"scene_{i}"
    )

    if image_url:
        scene_image_urls.append(image_url)  # –î–æ–±–∞–≤–ª—è–µ–º URL –≤ –ö–û–ù–ï–¶ —Å–ø–∏—Å–∫–∞
        logger.info(f"‚úÖ –§–æ—Ç–æ {i}: {image_url}")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
scene_image_urls = [
    "https://i.ibb.co/abc123.jpg",  # –∏–Ω–¥–µ–∫—Å 0 ‚Üí –§–æ—Ç–æ 1 ‚Üí URL 1
    "https://i.ibb.co/def456.jpg",  # –∏–Ω–¥–µ–∫—Å 1 ‚Üí –§–æ—Ç–æ 2 ‚Üí URL 2
    "https://i.ibb.co/ghi789.jpg"   # –∏–Ω–¥–µ–∫—Å 2 ‚Üí –§–æ—Ç–æ 3 ‚Üí URL 3
]
```

---

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω (handlers/video_handler.py, lines 735-743)

```python
scenes = []
for i in range(len(scene_image_urls)):  # i = 0, 1, 2
    scenes.append({
        "id": i + 1,  # id = 1, 2, 3
        "prompt": f"{prompt} - –ß–∞—Å—Ç—å {i + 1}",
        "duration": 5,
        "aspect_ratio": "16:9"
    })
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
scenes = [
    {"id": 1, "prompt": "...- –ß–∞—Å—Ç—å 1", ...},  # –∏–Ω–¥–µ–∫—Å 0
    {"id": 2, "prompt": "...- –ß–∞—Å—Ç—å 2", ...},  # –∏–Ω–¥–µ–∫—Å 1
    {"id": 3, "prompt": "...- –ß–∞—Å—Ç—å 3", ...}   # –∏–Ω–¥–µ–∫—Å 2
]
```

**–í–∞–∂–Ω–æ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ü–µ–Ω = –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ñ–æ—Ç–æ!

- 1 —Ñ–æ—Ç–æ ‚Üí 1 —Å—Ü–µ–Ω–∞
- 3 —Ñ–æ—Ç–æ ‚Üí 3 —Å—Ü–µ–Ω—ã
- 5 —Ñ–æ—Ç–æ ‚Üí 5 —Å—Ü–µ–Ω

---

### –®–∞–≥ 4: –ü–µ—Ä–µ–¥–∞—á–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (handlers/video_handler.py, lines 761-765)

```python
scene_results = await generator.generate_multiple_scenes(
    scenes=scenes,                        # –°—Ü–µ–Ω—ã (–∏–Ω–¥–µ–∫—Å 0, 1, 2, ...)
    model=model_key,
    scene_image_urls=scene_image_urls    # URLs (–∏–Ω–¥–µ–∫—Å 0, 1, 2, ...)
)
```

---

### –®–∞–≥ 5: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ (video_generator.py, lines 391-410)

```python
for i, scene in enumerate(scenes):  # i = 0, 1, 2
    scene_image = None

    if scene_image_urls and i < len(scene_image_urls):
        scene_image = scene_image_urls[i]  # ‚Üê –ì–õ–ê–í–ù–û–ï: —Å—Ü–µ–Ω–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º i
                                            #   –ø–æ–ª—É—á–∞–µ—Ç —Ñ–æ—Ç–æ —Å –∏–Ω–¥–µ–∫—Å–æ–º i!

    task = self.generate_scene(
        prompt=scene["prompt"],
        model=model,
        duration=scene.get("duration", 5),
        aspect_ratio=scene.get("aspect_ratio", "16:9"),
        start_image_url=scene_image,  # ‚Üê –ü–µ—Ä–µ–¥–∞–µ–º —Ñ–æ—Ç–æ –î–õ–Ø –≠–¢–û –°–¶–ï–ù–´
        scene_number=i + 1
    )
```

**–õ–æ–≥–∏–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è:**

| i (–∏–Ω–¥–µ–∫—Å) | scene[i]          | scene_image_urls[i]           | –†–µ–∑—É–ª—å—Ç–∞—Ç             |
| ---------- | ----------------- | ----------------------------- | --------------------- |
| 0          | –°—Ü–µ–Ω–∞ 1 (—á–∞—Å—Ç—å 1) | "https://i.ibb.co/abc123.jpg" | –°—Ü–µ–Ω–∞ 1 + —Ñ–æ—Ç–æ –ø–ª—è–∂–∞  |
| 1          | –°—Ü–µ–Ω–∞ 2 (—á–∞—Å—Ç—å 2) | "https://i.ibb.co/def456.jpg" | –°—Ü–µ–Ω–∞ 2 + —Ñ–æ—Ç–æ –∑–∞–∫–∞—Ç–∞ |
| 2          | –°—Ü–µ–Ω–∞ 3 (—á–∞—Å—Ç—å 3) | "https://i.ibb.co/ghi789.jpg" | –°—Ü–µ–Ω–∞ 3 + —Ñ–æ—Ç–æ –ø–∞–ª—å–º  |

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### –ü—Ä–∞–≤–∏–ª–æ 1: –ü–æ—Ä—è–¥–æ–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω

```
–ó–∞–≥—Ä—É–∂–µ–Ω–æ –≤ —ç—Ç–æ–º –ø–æ—Ä—è–¥–∫–µ:
1Ô∏è‚É£ –§–æ—Ç–æ –ê (–ø–ª—è–∂)
2Ô∏è‚É£ –§–æ—Ç–æ –í (–∑–∞–∫–∞—Ç)
3Ô∏è‚É£ –§–æ—Ç–æ –° (–ø–∞–ª—å–º—ã)

‚Üì

–°—Ü–µ–Ω—ã –±—É–¥—É—Ç —Ç–∞–∫–∏–µ:
üìπ –°—Ü–µ–Ω–∞ 1 = –§–æ—Ç–æ –ê (–ø–ª—è–∂)
üìπ –°—Ü–µ–Ω–∞ 2 = –§–æ—Ç–æ –í (–∑–∞–∫–∞—Ç)
üìπ –°—Ü–µ–Ω–∞ 3 = –§–æ—Ç–æ –° (–ø–∞–ª—å–º—ã)

‚Üì –ù–ï–õ–¨–ó–Ø –ü–ï–†–ï–°–¢–ê–í–ò–¢–¨! ‚Üì
```

### –ü—Ä–∞–≤–∏–ª–æ 2: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ü–µ–Ω = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ

```
–ó–∞–≥—Ä—É–∑–∏–ª–∏ 3 —Ñ–æ—Ç–æ ‚Üí –±—É–¥–µ—Ç 3 —Å—Ü–µ–Ω—ã (–ø–æ 5 —Å–µ–∫ –∫–∞–∂–¥–∞—è)
–ó–∞–≥—Ä—É–∑–∏–ª–∏ 1 —Ñ–æ—Ç–æ ‚Üí –±—É–¥–µ—Ç 1 —Å—Ü–µ–Ω–∞ (5 —Å–µ–∫)
–ó–∞–≥—Ä—É–∑–∏–ª–∏ 5 —Ñ–æ—Ç–æ ‚Üí –±—É–¥–µ—Ç 5 —Å—Ü–µ–Ω (25 —Å–µ–∫ –≤—Å–µ–≥–æ)
```

### –ü—Ä–∞–≤–∏–ª–æ 3: –ü—Ä–æ–º—Ç –æ–¥–∏–Ω, –Ω–æ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –ø—Ä–æ–º—Ç:
"–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ —Å –ø–∞–ª—å–º–∞–º–∏"

‚Üì

–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç:
- –°—Ü–µ–Ω–∞ 1: "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ —Å –ø–∞–ª—å–º–∞–º–∏ - –ß–∞—Å—Ç—å 1" + —Ñ–æ—Ç–æ 1
- –°—Ü–µ–Ω–∞ 2: "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ —Å –ø–∞–ª—å–º–∞–º–∏ - –ß–∞—Å—Ç—å 2" + —Ñ–æ—Ç–æ 2
- –°—Ü–µ–Ω–∞ 3: "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂ —Å –ø–∞–ª—å–º–∞–º–∏ - –ß–∞—Å—Ç—å 3" + —Ñ–æ—Ç–æ 3

–ü—Ä–æ–º—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω, –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä —á–∞—Å—Ç–∏ –∏ —Ñ–æ—Ç–æ!
```

---

## üé® –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: 3 —Ñ–æ—Ç–æ —Ä–∞–∑–Ω—ã—Ö –ø–ª—è–∂–µ–π

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
  –ü—Ä–æ–º—Ç: "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –ø–ª—è–∂–∞–º –º–∏—Ä–∞"
  üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
    1. –§–æ—Ç–æ –±–µ–ª–æ–≥–æ –ø–ª—è–∂–∞ –Ω–∞ –ú–∞–ª—å–¥–∏–≤–∞—Ö
    2. –§–æ—Ç–æ —á—ë—Ä–Ω–æ–≥–æ –ø–ª—è–∂–∞ –≤ –ò—Å–ª–∞–Ω–¥–∏–∏
    3. –§–æ—Ç–æ —Ä–æ–∑–æ–≤–æ–≥–æ –ø–ª—è–∂–∞ –Ω–∞ –ë–µ—Ä–º—É–¥–∞—Ö

–°–∏—Å—Ç–µ–º–∞:
  ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 3 —Ñ–æ—Ç–æ
  ‚úÖ –°–æ–∑–¥–∞–Ω–æ 3 —Å—Ü–µ–Ω—ã
  ‚úÖ –ö–∞–∂–¥–æ–π —Å—Ü–µ–Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –°–í–û–ï —Ñ–æ—Ç–æ:

  üìπ –°—Ü–µ–Ω–∞ 1: –ø—Ä–æ–º—Ç + –±–µ–ª—ã–π –ø–ª—è–∂ ‚Üí Video 1
  üìπ –°—Ü–µ–Ω–∞ 2: –ø—Ä–æ–º—Ç + —á—ë—Ä–Ω—ã–π –ø–ª—è–∂ ‚Üí Video 2
  üìπ –°—Ü–µ–Ω–∞ 3: –ø—Ä–æ–º—Ç + —Ä–æ–∑–æ–≤—ã–π –ø–ª—è–∂ ‚Üí Video 3

–†–µ–∑—É–ª—å—Ç–∞—Ç:
  üé¨ –§–∏–Ω–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ = Video1 + Video2 + Video3
     (15 —Å–µ–∫: –∫–∞–∂–¥–æ–µ –≤–∏–¥–µ–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –°–í–û–ï–ì–û —Ñ–æ—Ç–æ)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: 1 —Ñ–æ—Ç–æ

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
  –ü—Ä–æ–º—Ç: "–î–µ–≤—É—à–∫–∞ —Ç–∞–Ω—Ü—É–µ—Ç"
  üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
    1. –§–æ—Ç–æ –¥–µ–≤—É—à–∫–∏

–°–∏—Å—Ç–µ–º–∞:
  ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 1 —Ñ–æ—Ç–æ
  ‚úÖ –°–æ–∑–¥–∞–Ω–æ 1 —Å—Ü–µ–Ω–∞

  üìπ –°—Ü–µ–Ω–∞ 1: "–î–µ–≤—É—à–∫–∞ —Ç–∞–Ω—Ü—É–µ—Ç - –ß–∞—Å—Ç—å 1" + —Ñ–æ—Ç–æ

–†–µ–∑—É–ª—å—Ç–∞—Ç:
  üé¨ –§–∏–Ω–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ = Video1 (5 —Å–µ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–æ—Ç–æ)
```

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ –ª–æ–≥–∞—Ö

–ö–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ç–æ, –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –ª–æ–≥–∏:

```
üì∏ –§–æ—Ç–æ 1/3: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é...
‚úÖ –§–æ—Ç–æ 1: https://i.ibb.co/abc123.jpg
üì∏ –§–æ—Ç–æ 2/3: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é...
‚úÖ –§–æ—Ç–æ 2: https://i.ibb.co/def456.jpg
üì∏ –§–æ—Ç–æ 3/3: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é...
‚úÖ –§–æ—Ç–æ 3: https://i.ibb.co/ghi789.jpg

‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 3 —Ñ–æ—Ç–æ

üé¨ –°–æ–∑–¥–∞–Ω–æ 3 —Å—Ü–µ–Ω –¥–ª—è –≤–∏–¥–µ–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

‚ö° –û—Ç–ø—Ä–∞–≤–ª—è—é 3 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ...

–°—Ü–µ–Ω–∞ 1: –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ
–°—Ü–µ–Ω–∞ 2: –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ
–°—Ü–µ–Ω–∞ 3: –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ
```

---

## üö´ –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### ‚ùå –û—à–∏–±–∫–∞ 1: –û–∂–∏–¥–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞

```
–ó–∞–≥—Ä—É–∂–µ–Ω–æ:        –û–∂–∏–¥–∞–µ—Ç—Å—è:        –ü–æ–ª—É—á–∞–µ—Ç—Å—è:
1. –§–æ—Ç–æ –ø–ª—è–∂–∞  ‚Üí  –°—Ü–µ–Ω–∞ 1 –ø–ª—è–∂  ‚Üí  –°—Ü–µ–Ω–∞ 1 –ø–ª—è–∂ ‚úÖ
2. –§–æ—Ç–æ –Ω–µ–±–∞   ‚Üí  –°—Ü–µ–Ω–∞ 2 –Ω–µ–±–æ  ‚Üí  –°—Ü–µ–Ω–∞ 2 –Ω–µ–±–æ ‚úÖ
3. –§–æ—Ç–æ –∑–∞–∫–∞—Ç  ‚Üí  –°—Ü–µ–Ω–∞ 3 –∑–∞–∫–∞—Ç ‚Üí  –°—Ü–µ–Ω–∞ 3 –∑–∞–∫–∞—Ç ‚úÖ

–í—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ
```

### ‚ùå –û—à–∏–±–∫–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ

```
–ó–∞–≥—Ä—É–∂–µ–Ω–æ 2 —Ñ–æ—Ç–æ, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –∂–¥—ë—Ç 3:
‚ùå –°—Ü–µ–Ω–∞ 3 –ø–æ–ª—É—á–∏—Ç —Ñ–æ—Ç–æ 2 (–∏–ª–∏ –æ—à–∏–±–∫—É)

–†–µ—à–µ–Ω–∏–µ:
–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ!
```

### ‚ùå –û—à–∏–±–∫–∞ 3: –ó–∞–±—ã–ª–∏ –Ω–∞–∂–∞—Ç—å "/–≥–æ—Ç–æ–≤–æ"

```
–ó–∞–≥—Ä—É–∂–µ–Ω–æ 3 —Ñ–æ—Ç–æ, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –∂–¥—ë—Ç –∫–æ–º–∞–Ω–¥—É:
‚è≥ –°–∏—Å—Ç–µ–º–∞ –∂–¥—ë—Ç /–≥–æ—Ç–æ–≤–æ

–†–µ—à–µ–Ω–∏–µ:
–ù–∞–ø–∏—à–∏—Ç–µ /–≥–æ—Ç–æ–≤–æ –∫–æ–≥–¥–∞ –≤—Å–µ —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!
```

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ä–µ–∑

```
–°–æ—Å—Ç–æ—è–Ω–∏–µ FSM (–≤ –ø–∞–º—è—Ç–∏ –±–æ—Ç–∞):
{
    "prompt": "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂",
    "model": "kwaivgi/kling-v2.5-turbo-pro",
    "photos": [file_id_1, file_id_2, file_id_3]  ‚Üê Telegram file_ids
}

        ‚Üì process_text_photo_image –≤—ã–∑—ã–≤–∞–µ—Ç start_text_photo_generation ‚Üì

–§—É–Ω–∫—Ü–∏—è start_text_photo_generation():
{
    "photo_file_ids": [file_id_1, file_id_2, file_id_3],
    "prompt": "–ö—Ä–∞—Å–∏–≤—ã–π –ø–ª—è–∂",
    "model": "kwaivgi/kling-v2.5-turbo-pro"
}

        ‚Üì –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ ImgBB ‚Üì

{
    "scene_image_urls": [
        "https://i.ibb.co/abc123.jpg",
        "https://i.ibb.co/def456.jpg",
        "https://i.ibb.co/ghi789.jpg"
    ]
}

        ‚Üì –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω ‚Üì

{
    "scenes": [
        {"id": 1, "prompt": "... - –ß–∞—Å—Ç—å 1", ...},  # –∏–Ω–¥–µ–∫—Å 0
        {"id": 2, "prompt": "... - –ß–∞—Å—Ç—å 2", ...},  # –∏–Ω–¥–µ–∫—Å 1
        {"id": 3, "prompt": "... - –ß–∞—Å—Ç—å 3", ...}   # –∏–Ω–¥–µ–∫—Å 2
    ]
}

        ‚Üì –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ Replicate ‚Üì

generate_multiple_scenes(
    scenes=[s0, s1, s2],
    scene_image_urls=[url0, url1, url2]
)

        ‚Üì –¶–∏–∫–ª –≤ generate_scene ‚Üì

for i in range(3):
    task = generate_scene(..., start_image_url=scene_image_urls[i])

i=0: generate_scene(..., start_image_url=url0)  ‚Üí Video 1
i=1: generate_scene(..., start_image_url=url1)  ‚Üí Video 2
i=2: generate_scene(..., start_image_url=url2)  ‚Üí Video 3
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–æ—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–ø–æ—Ä—è–¥–∫–æ–º –∑–∞–≥—Ä—É–∑–∫–∏** ‚Äî –∫–∞–∂–¥–æ–º—É —Ñ–æ—Ç–æ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –Ω–æ–º–µ—Ä –≤ –ø–æ—Ä—è–¥–∫–µ (1, 2, 3...), –∏ —ç—Ç–∞ –Ω—É–º–µ—Ä–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ü–µ–Ω–∞–º **–æ–¥–∏–Ω-–≤-–æ–¥–∏–Ω**.

```
–§–æ—Ç–æ 1 (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–µ—Ä–≤—ã–º) ‚Üí –°—Ü–µ–Ω–∞ 1
–§–æ—Ç–æ 2 (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –≤—Ç–æ—Ä—ã–º) ‚Üí –°—Ü–µ–Ω–∞ 2
–§–æ—Ç–æ 3 (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Ç—Ä–µ—Ç—å–∏–º) ‚Üí –°—Ü–µ–Ω–∞ 3
```

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–∞–∂–¥–æ–π —Å—Ü–µ–Ω–µ –¥–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ —Ç–æ —Ñ–æ—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã —Ö–æ—Ç–µ–ª–∏! üéØ
